# سبق 5: ریٹریول-اگمنٹڈ جنریشن (آر اے جی) کے ساتھ اپنے ڈیٹا سے بات کریں

اس باب میں آپ سیکھیں گے:

- ریٹریول-اگمنٹڈ جنریشن (آر اے جی) کی بنیادی باتیں اور اسے جنریٹو اے آئی ماڈلز کے ردعمل کو بڑھانے کے لئے کس طرح استعمال کیا جاسکتا ہے۔
- بیرونی ڈیٹا ذرائع کو اپنی اے آئی ایپلیکیشن میں ضم کرنے کا طریقہ۔
- اے ائی سے تیار کردہ مواد کی مطابقت اور درستگی کو بہتر بنانے کے لئے اپنے ڈیٹا کا فائدہ کیسے اٹھائیں۔

## سیٹ اپ

اگر آپ نے پہلے نہیں کیا ہے تو، اپنے ڈویلپمنٹ انوارمنٹ کو ترتیب دیں۔ یہاں ہے کہ آپ یہ کیسے کر سکتے ہیں: [اپنے ڈویلپمنٹ انوارمنٹ کو ترتیب دیں](/docs/setup/README.md)۔

## متعلقہ وسائل

[![Watch a short video about RAG](https://img.youtube.com/vi/xkFOmx5yxIA/0.jpg)](https://www.youtube.com/watch?v=xkFOmx5yxIA&list=PLlrxD0HtieHi5ZpsHULPLxm839IrhmeDk&index=4)

_یہ ویڈیو ریٹریول اگمنٹڈ جنریشن (آر اے جی) کی وضاحت کرتی ہے، ایک ایسا طریقہ جو اے ائی کو بہتر نتائج  کے لئے اپنے تربیتی ڈیٹا کے ساتھ آپ کے مواد کو استعمال کرنے میں مدد کرتی ہے۔_

*🎥 ریٹریول اگمنٹڈ جنریشن (آر اے جی) کے بارے میں ایک مختصر ویڈیو دیکھنے کے لئے اوپر کی تصویر پر کلک کریں*

💼 سلائیڈز: [ریٹریول اگمنٹڈ جنریشن ، آر اے جی](../../videos/slides/03-rag.pptx)

## بیانیہ - پیدائش

> [نوٹ!] 

> _ہماری اب تک کی کہانی. آپ 1860 کی دہائی لندن کے مکینک ہیں۔ آپ اپنے آٹومیٹن پر کام کر رہے تھے اور چارلس بیبیج کی طرف سے ایک خط موصول ہوا جو آپ کو ایک لائبریری میں لے گیا جہاں آپ نے ٹائم ٹریول ڈیوائس اٹھائی۔ اپنے سفر کے دوران آپ فلورنس پہنچے، جہاں آپ لیونارڈو ڈا ونچی سے ملے۔ آپ ایزٹیک سلطنت میں بھی گئے تھے اور یہی وہ جگہ ہے جہاں_. کہانی جاری ہوتی ہے
>
> دیکھیں [سبق 1](../01-intro-to-genai/README.md) اگر آپ شروع سے ہی کہانی کو پڑھنا چاہتے ہیں۔ 

> [نوٹ!] 

> اگرچہ ہم کہانی کو پڑھنے کی سفارش کرتے ہیں (یہ مزہ ہے!)، [یہاں کلک کریں](interact-with-ada-lovelace#) اگر آپ براہ راست تکنیکی مواد پر جانے کو ترجیح دیتے ہیں.

**آپ**: "لیونارڈو، جانے کا وقت آ گیا ہے،" آپ نے بٹن دباتے ہوئے کہا۔ یہ آلہ زندہ ہو گیا، اور ایک میکانی آواز گونج اٹھی، "یہ گھر جانے کا وقت ہے، یہ 'پیدائش' کا وقت ہے۔

**لیونارڈو:** " ?Genesis? Che cosa significa" لیونارڈو نے الجھن میں پوچھا۔ اس سے پہلے کہ آپ جواب دے پاتے، دنیا رنگوں اور آوازوں کے دھندلے پن میں تحلیل ہو گئی، وقت گزرنے کے ساتھ ہی مندر غائب ہو گیا۔

آپ باغ میں اترتے ہیں، رات ہو چکی ہے اور گہری دھند ہے اور دور سے خوفناک روشنیاں چمک رہی ہیں۔ حویلی آپ کے سامنے منڈلا رہی ہے۔ لیونارڈو نے چاروں طرف دیکھا، حیرت سے اس کی آنکھیں کھلی ہوئی تھیں۔

<div>
   <img src="https://raw.githubusercontent.com/microsoft/generative-ai-with-javascript/main/lessons/05-rag/assets/mansion.jpeg" alt="Mansion Image" width="300">
</div>
### کتوں سے بھاگنا

آپ کو بھونکنے اور کتوں کی آواز یں سنائی دیتی ہیں جو آپ کی طرف دوڑ رہے ہیں۔ آپ لیونارڈو کی طرف مڑتے ہیں، "ہمیں ابھی اندر جانے کی ضرورت ہے!"

<div>
   <img src="https://raw.githubusercontent.com/microsoft/generative-ai-with-javascript/main/lessons/05-rag/assets/dogs.jpeg" alt="Dogs Image" width="300">
</div>

جیسے ہی آپ حویلی کے دروازے تک پہنچتے ہیں تو یہ کھل جاتا ہے اور خدمت گاروں کا ایک جوڑا جلدی سے باہر نکل جاتا ہے۔ آپ کو پریشان کرنے کے بعد، وہ آپ کو ان کی پیروی کرنے کی ترغیب دیتے ہیں.

آپ ایڈا لولیس کے ساتھ آمنے سامنے آتے ہیں ، اس کی آنکھیں تجسس سے چمکتی ہیں۔

### ایڈا اور چارلس سے ملاقات

**ایڈا:** "اوہ، اب وقت آ گیا ہے کہ آپ آ جائیں،" اس نے گرمجوشی سے کہا. " ہمیں آپ کی ایک کام میں ضرورت ہے. "

**آپ:** "وقت کے بارے میں"، آپ یہ کہتی رہتی ہیں. ڈائنوکریٹس نے بھی یہی کہا، لیکن مجھے یقین نہیں ہے کہ آپ کا مطلب کیا ہے؟

**ایڈا:** ہش، اب اس کے لئے وقت نہیں ہے، ہمیں اس آلے کے بارے میں بات کرنے کی ضرورت ہے جو آپ کے پاس ہے. 

**آپ:** لیکن ..

<div>
   <img src="https://raw.githubusercontent.com/microsoft/generative-ai-with-javascript/main/lessons/05-rag/assets/ada.jpeg" alt="Ada Image" width="300">
</div>

چارلس بیبیج آپ کے ہاتھ میں موجود ٹائم بیٹل کی جانچ پڑتال کرتے ہوئے آگے بڑھتا ہے۔ "یہ آلہ قابل ذکر ہے، لیکن یہ تھوڑا سا ناقص ہے، ہے نا؟ آپ نے نوٹ کیا ہے، مجھے یقین ہے. "

لیونارڈو نے سر ہلایا، "سی، یہ عجیب طریقے سے کام کر رہا ہے."

**ایڈا:** ڈیوائس بالکل تیار نہیں ہے، ہمیں اسے مزید صلاحیتیں دینے کی ضرورت ہے. ہمیں اسے اسمارٹ بنانے اور اس کے آس پاس کی دنیا کے بارے میں زیادہ آگاہ کرنے کی ضرورت ہے۔ خیال یہ ہے کہ یہ مختلف اوقات سے معلومات حاصل کرنے کے قابل ہو اور اسے درست اور متعلقہ جوابات پیدا کرنے کے لئے استعمال کرے۔ کیا آپ اس میں مدد کر سکتے ہیں؟

**آپ:** یقینا، ایسا لگتا ہے کہ ہمیں اعداد و شمار کے ساتھ آلے کے جوابات کو بڑھانے کی ضرورت ہے، سمجھ میں آتا ہے.

**ایڈا:** آئیے ایک تصور کے بارے میں بات کرتے ہیں جسے میں آر اے جی ، یا ریٹریول -اگمنٹڈ جنریشن کہنا چاہتی ہوں۔

## ایڈا لولیس کے ساتھ بات چیت کریں

اگر آپ ایڈا کے ساتھ بات چیت کرنا چاہتے ہیں تو، [حروف](/app/README.md) ایپ چلائیں۔ 

> [اہم!]

> یہ مکمل طور پر خیالی ہے۔ جوابات  اے ائی کے ذریعہ تیار کیے جاتے ہیں۔
> [ذمہ دار اے ائی کا اعلان](/README.md#responsible-ai-disclaimer)

<div>
   <img src="https://raw.githubusercontent.com/microsoft/generative-ai-with-javascript/main/lessons/05-rag/assets/ada-2.jpeg" alt="Ada 2 Image" width="300">
</div>

**اقدامات**:

1. شروع کریں [![GitHub Codespace](https://img.shields.io/badge/GitHub-Codespace-brightgreen)](https://codespaces.new/microsoft/generative-ai-with-javascript)
2. ریپو روٹ میں _/app_  پر جائیں۔
3. کنسول کو تلاش کریں اور `npm install`  چلائیں جس کے بعد `npm start` چلائیں ۔
4. ایک بار جب یہ ظاہر ہوتا ہے تو، "براؤزر میں کھولیں" بٹن منتخب کریں۔
5. ایڈا کے ساتھ بات چیت کریں.

ایپ کی مزید تفصیلی وضاحت کے لئے ، دیکھیں [تفصیلی ایپ وضاحت](/lessons/01-intro-to-genai/README.md#interact-with-dinocrates)۔

> [نوٹ!]

 > اگر آپ اپنی مشین پر مقامی طور پر پروجیکٹ چلا رہے ہیں تو، براہ کرم [گٹ ہب ذاتی رسائی](../../docs/setup/README.md#creating-a-personal-access-token-pat-for-github-model-access) ٹوکن سیٹ اپ حاصل کرنے کے لئے کوئیک اسٹارٹ گائیڈ کا جائزہ لیں اور کوڈ میں کلید کو تبدیل کریں۔

## لارج لینگوج ماڈلز، ایل ایل ایم ز کے ساتھ معروف چیلنجز

**ایڈا:** آئیے اس اے ائی پر تبادلہ خیال کرکے شروع کریں جو ہم ڈیوائس کو طاقت دینے کے لئے استعمال کریں گے۔ ہم ردعمل کے معیار کو بڑھانے کے لئے ڈیٹا ریٹریول کے نظام کے ساتھ جوڑے گئے "اے آئی ماڈلز" پر انحصار کریں گے۔

سب سے پہلے، آپ کو آر اے جی کی تفصیلات میں غوطہ لگانے سے پہلے کچھ چیلنجوں کو حل کرنے کی ضرورت ہے. وسیع ٹیکسٹ ڈیٹا پر تربیت یافتہ یہ ماڈل متعلقہ اور درست جوابات پیدا کرسکتے ہیں۔ لیکن ، کسی بھی ڈیٹا ماخذ کی طرح ، ان کی آؤٹ پٹ مختلف عوامل کی وجہ سے غلط ، نامکمل ، یا گمراہ کن ہوسکتی ہے۔

- **پرانے ذرائع:** ماڈل کی تربیت کے لئے استعمال ہونے والا ڈیٹا فرسودہ ہوسکتا ہے اور درست نہیں ہے.
- **غلط معلومات:** ماڈل کی تربیت کے لئے استعمال ہونے والے ذرائع میں غلط یا گمراہ کن معلومات شامل ہوسکتی ہیں، جیسے جعلی خبریں یا متعصبانہ رائے.
- **غیر مستند ذرائع:** ماڈل اپنے تربیتی اعداد و شمار میں مستند اور غیر مستند ذرائع کے درمیان فرق کرنے کے قابل نہیں ہوسکتا ہے، جس کی وجہ سے ناقابل اعتماد معلومات پیدا ہوتی ہیں.

اس سے یہ بتانا مشکل ہوجاتا ہے کہ آیا ایل ایل ایم کے ذریعہ تیار کردہ معلومات صحیح ہیں یا نہیں۔ یہ وہ جگہ ہے جہاں آر اے جی آتا ہے۔

**آپ:** لہذا مجھے اس بات کو یقینی بنانے کی ضرورت ہے کہ آلہ درست معلومات فراہم کرسکتا ہے، یہاں تک کہ جب اسے جواب کے بارے میں یقین نہیں ہے؟

**ایڈا:** جی ہاں، یہی خیال ہے. ریٹریول پر مبنی طریقوں اور جنریٹو ماڈل کی طاقتوں کو یکجا کرکے ، ہم ایک بہتر اے آئی سسٹم حاصل کرتے ہیں۔

## ریٹریول-اگمنٹڈ جنریشن، آر اے جی کے بنیادی تصورات

**ایڈا:** جی ہاں، آر اے جی پر خاص طور پر تبادلہ خیال کرنے کا وقت ہے. آئیے کچھ بنیادی باتوں سے شروع کرتے ہیں:

ریٹریول-اگمنٹڈ جنریشن (آر اے جی) ایک طاقتور تکنیک ہے جونیچرل لینگوج  پروسیسنگ میں دو مختلف طریقوں کی طاقتوں کو یکجا کرتی ہے: ریٹریول پر مبنی طریقے اور جنریٹو ماڈل۔ یہ ہائبرڈ نقطہ نظر ایسے جوابات کی تخلیق کی اجازت دیتا ہے جو سیاق و سباق سے متعلق ہیں اور مواد سے مالا مال ہیں ، تاکہ ایل ایل ایم کے ساتھ کچھ معروف چیلنجوں کو کم کرنے میں مدد مل سکے۔

اس کے مرکز میں ، آر اے جی میں دو اہم اجزاء شامل ہیں: ایک **ریٹریور** اور ایک **جنریٹر**

- **ریٹریور:** یہ بیرونی ڈیٹا ذرائع سے متعلقہ معلومات تلاش کرنے کے لئے ذمہ دار ہے جو سرچ انجن کی طرح اے ائی سے پیدا کردہ جوابات کو بہتر بنانے کے لئے استعمال کیا جاسکتا ہے. یہ معلومات متن ، تصاویر ، یا کسی اور قسم کے ڈیٹا کی شکل میں ہوسکتی ہے جو گفتگو کے سیاق و سباق سے متعلق ہے، حالانکہ متن استعمال ہونے والا سب سے عام قسم کا ڈیٹا ہے۔
- **جنریٹر:** یہ ریٹریول شدہ معلومات لیتا ہے اور اسے ایک جواب پیدا کرنے کے لئے استعمال کرتا ہے جو سیاق و سباق سے متعلق اور معلوماتی ہے.

آر اے جی سسٹم کس طرح کام کرتا ہے اس کی وضاحت کرنے والا ایک اسکیما یہ ہے:

![RAG Image](https://github.com/microsoft/generative-ai-with-javascript/blob/main/lessons/05-rag/assets/rag.png)

1. **صارف ان پٹ:** صارف ایک سوال پوچھتا ہے.
2. **ریٹریور:** ریٹریور جزو ایک یا ایک سے زیادہ علم کی بنیادوں کا استعمال کرتے ہوئے متعلقہ معلومات کی تلاش کرتا ہے.
3. **اگمنٹڈ پرامپٹ:** ریٹریول شدہ معلومات کو صارف کے سوال اور سیاق و سباق کے ساتھ ملایا جاتا ہے، تاکہ ایک اگمنٹڈ پرامپٹ بنایا جاسکے۔
4. **جنریٹر:** ایل ایل ایم جواب پیدا کرنے کے لئے اگمنٹڈ پرامپٹ کا استعمال کرتا ہے.

یہ امتزاج ماڈل کے تربیتی ڈیٹا پر انحصار کرنے کے بجائے فراہم کردہ ڈیٹا کا استعمال کرکے زیادہ درست اور متعلقہ جوابات کی اجازت دیتا ہے۔

**ایڈا:** سوالات؟

**آپ:** تو ریٹریور معلومات تلاش کرتا ہے اور جنریٹر جواب پیدا کرنے کے لئے اس کا استعمال کرتا ہے؟

**ایڈا:** بالکل، آپ کو اس کا فائدہ مل رہا ہے.

## بیرونی ڈیٹا ذرائع کو مربوط کرنا

**ایڈا:** اب جبکہ ہم نے آر اے جی کی بنیادی باتوں کا احاطہ کیا ہے ، آئیے اس بارے میں بات کرتے ہیں کہ آپ اپنی اے آئی ایپلیکیشن میں بیرونی ڈیٹا ذرائع کو کس طرح ضم کرسکتے ہیں۔

بیرونی ڈیٹا ذرائع کو آپ کی اے آئی ایپلیکیشن میں ضم کرنا مختلف طریقوں سے کیا جاسکتا ہے، اس پر منحصر ہے کہ آپ کس قسم کے ڈیٹا کا استعمال کرنا چاہتے ہیں اور ریٹریول کے میکانزم کی پیچیدگی۔ یہاں کچھ عام طریقے ہیں:

- **اے پی آئی:** بہت سے بیرونی ڈیٹا ذرائع اے پی آئی فراہم کرتے ہیں جو آپ کو پروگرامی طور پر ان کے ڈیٹا تک رسائی حاصل کرنے کی اجازت دیتے ہیں. آپ ان اے پی آئیز کو حقیقی وقت میں معلومات بازیافت کرنے کے لئے استعمال کرسکتے ہیں اور اسے اے آئی سے تیار کردہ جوابات کو بڑھانے کے لئے استعمال کرسکتے ہیں۔
- **ڈیٹا بیس:** اگر آپ کے پاس بڑی مقدار میں ڈیٹا ہے جسے آپ ریٹریول کے لئے استعمال کرنا چاہتے ہیں تو ، آپ اسے ڈیٹا بیس میں اسٹور کرسکتے ہیں اور ضرورت کے مطابق اس سے پوچھ گچھ کرسکتے ہیں۔ یہ اسٹرکچرڈ ڈیٹا کے لئے مفید ہوسکتا ہے جس تک تیزی سے رسائی حاصل کرنے کی ضرورت ہے۔

ایک بار جب آپ بیرونی ڈیٹا ذرائع کو ضم کرنے کے طریقہ کار پر فیصلہ کر لیتے ہیں تو ، آپ کو اس بات پر بھی غور کرنے کی ضرورت ہوسکتی ہے کہ ڈیٹا کو کس طرح پری پروسیس اور فارمیٹ کیا جائے تاکہ اسے آسانی سے اے آئی ماڈل کے ذریعہ استعمال کیا جاسکے۔ اس میں ڈیٹا کو صاف کرنا ، اسے مناسب فارمیٹ (جیسے سادہ متن یا مارک ڈاؤن) میں تبدیل کرنا ، یا آسانی سے ریٹریول کے لئے اسے چھوٹے حصوں میں تقسیم کرنا شامل ہوسکتا ہے۔

> [نوٹ!]

> آپ کی اے آئی ایپلیکیشن میں بیرونی ڈیٹا ذرائع کو ضم کرتے وقت ، ڈیٹا تک رسائی اور اسٹور کرنے کی رازداری اور سیکیورٹی مضمرات پر غور کرنا ضروری ہے۔ اس بات کو یقینی بنائیں کہ آپ کے پاس ڈیٹا کی حفاظت اور کسی بھی متعلقہ قواعد و ضوابط کی تعمیل کرنے کے لئے ضروری اجازتیں اور حفاظتی اقدامات موجود ہیں۔

اگر آپ ڈیٹا بیس استعمال کر رہے ہیں تو ، آپ اس بارے میں بھی سوچنا چاہتے ہیں کہ آپ سب سے زیادہ متعلقہ معلومات کو ریٹریو کرنے کے لئے اپنے ڈیٹا کو کس طرح تلاش کرنا چاہتے ہیں۔ یہ مطلوبہ الفاظ کی تلاش ، مکمل متن کی تلاش ، یا زیادہ جدید تکنیک جیسے سیمینٹک سرچ یا ویکٹر سرچ کا استعمال کرتے ہوئے کیا جاسکتا ہے جس کے لئے مخصوص انڈیکسنگ کی ضرورت ہوسکتی ہے۔ ہم مستقبل کے سبق میں جدید تلاش کی تکنیک کا احاطہ کریں گے۔

**آپ**: کیا آپ اے پی آئی اور ڈیٹا بیس جیسی اصطلاحات کو 1860 کی دہائی کی اصطلاحات میں وضاحت کرسکتی ہیں؟

**ایڈا:** یقینا ، اے پی آئی ایک میسنجر کی طرح ہے جو پیغام کو ایک جگہ سے دوسری جگہ پہنچاتا ہے ، اور ڈیٹا بیس ایک لائبریری کی طرح ہے جہاں آپ اپنی تمام کتابیں ذخیرہ کرتے ہیں۔

**آپ**: اوہ، یہ سمجھ میں آتا ہے.

## پرامپٹ کو بڑھانا

**ایڈا:** کیا آپ اب بھی میرے ساتھ ہیں؟ اچھا، آئیے اگلے مرحلے پر چلتے ہیں، آئیے اے آئی ماڈل کو بھیجے گئے پرامپٹ کو بہتر بنانے کی کوشش کریں۔

**ایڈا:** ایک بار جب آپ اپنے ڈیٹا سے معلومات کھینچنے کا طریقہ ترتیب دیتے ہیں تو ، آپ اسے اے آئی ماڈل کے پرامپٹ میں شامل کرسکتے ہیں۔ اے آئی کے ردعمل کو چلانے کے لئے صرف بازیافت شدہ معلومات کو کچھ اضافی سیاق و سباق یا رہنمائی کے ساتھ ان پٹ متن میں مکس کریں۔

مثال کے طور پر ، اگر آپ کاروں کے بارے میں سوالات کا جواب دینے کے لئے ایک ایپ بنا رہے ہیں تو ، آپ کے پاس مندرجہ ذیل جیسے پرامپٹ ہوسکتے ہیں:

```متن

## ہدایات
صرف مندرجہ ذیل ذرائع کا استعمال کرتے ہوئے کاروں کے بارے میں سوالات کے جوابات دیں.
اگر فراہم کردہ ذرائع میں کافی اعداد و شمار نہیں ہیں تو ، کہیں کہ آپ نہیں جانتے ہیں۔
مختصر اور سیدھی بات کریں۔

## ذرائع
< ریٹریومعلومات یہاں محفوظ کریں>

## سوال
< سوال یہاں بیان کریں>
```


اضافی سیاق و سباق اور معلومات کے ساتھ اے آئی ماڈل فراہم کرکے ، آپ عمل کی رہنمائی کرنے میں مدد کرسکتے ہیں اور اس بات کو یقینی بناسکتے ہیں کہ جوابات درست اور متعلقہ موضوع سے متعلق ہیں۔

> [ٹپ!]

> پرامپٹ کے اس حصے کو نوٹ کریں: 'اگر فراہم کردہ ذرائع میں کافی ڈیٹا نہیں ہے، تو کہیں کہ آپ نہیں جانتے ہیں.' جب قابل اعتماد جواب فراہم کرنے کے لئے کافی ڈیٹا نہیں ہوتا ہے تو غلط معلومات پیدا کرنے والے اے آئی سے بچنے کے لئے یہ ضروری ہے۔ اس تکنیک کو *اسکیپ ہیچ* کہا جاتا ہے اور تیار کردہ مواد کے معیار کو یقینی بنانے کے لئے ایک اچھا عمل ہے.

آر اے جی کو *پرامپٹ انجینئرنگ* کی ایک اعلی درجے کی شکل کے طور پر سمجھا جا سکتا ہے.

### کوڈ کی مثال

**ایڈا:** مشق کامل بناتی ہے، لہذا ہم نے جو کچھ سیکھا ہے اسے ایک مثال کے ساتھ لاگو کریں. ہم ہائبرڈ کار ڈیٹا کی [سی ایس وی](https://fr.wikipedia.org/wiki/Comma-separated_values) فائل اور صارف کے سوال کی بنیاد پر متعلقہ معلومات کھینچنے کے لئے ایک بنیادی سرچ الگورتھم کا استعمال کرتے ہوئے جاوا اسکرپٹ ایپ میں ایک آسان ریٹریول کا نظام بنائیں گے۔

```javascript
// This example demonstrates how to use the Retrieval Augmented Generation (RAG)
// to answer questions based on a hybrid car data set.
// The code below reads the CSV file, searches for matches to the user question,
// and then generates a response based on the information found.

import { fileURLToPath } from 'node:url';
import { dirname } from 'node:path';
import process from "node:process";
import fs from "node:fs";
import { OpenAI } from "openai";

// Change the current working directory to the directory of the script
const __dirname = dirname(fileURLToPath(import.meta.url));
process.chdir(__dirname);

// 1. Ask a question about hybrid cars
// -----------------------------------

const question = `what's the fastest prius`;

// 2. Retriever component: search the data for relevant information
// ----------------------------------------------------------------

// Load CSV data as an array of objects
const rows = fs.readFileSync("./hybrid.csv", "utf8").split("\n");
const columns = rows[0].split(",");

// Search the data using a very naive search
const words = question
  .toLowerCase()
  .replaceAll(/[.?!()'":,]/g, "")
  .split(" ")
  .filter((word) => word.length > 2);
const matches = rows.slice(1).filter((row) => words.some((word) => row.toLowerCase().includes(word)));

// Format as a markdown table, since language models understand markdown
const table =
  `| ${columns.join(" | ")} |\n` +
  `|${columns.map(() => "---").join(" | ")}|\n` +
  matches.map((row) => `| ${row.replaceAll(",", " | ")} |\n`).join("");

console.log(`Found ${matches.length} matches:`);
console.log(table);

// 3. Context augmentation: create a combined prompt with the search results
// --------------------------------------------------------------------------

const augmentedPrompt = `
## Instructions
Answer questions about a time period or characters from said time period using only the sources below.
If there's not enough data in provided sources, say that you don't know.
Be brief and straight to the point.

## Sources
${table}

## Question
${question}
`;

// 4. Generator component: use the search results to generate a response
// ---------------------------------------------------------------------

const openai = new OpenAI({
  baseURL: "https://models.inference.ai.azure.com",
  apiKey: process.env.GITHUB_TOKEN,
});

const chunks = await openai.chat.completions.create({
  model: "gpt-4o-mini",
  messages: [{ role: "user", content: augmentedPrompt }],
  stream: true,
});

console.log(`Answer for "${question}":`);

for await (const chunk of chunks) {
  process.stdout.write(chunk.choices[0].delta.content ?? "");
}
```

آپ اس کوڈ کو [`example/rag-cars.js`](./example/rag-cars.js) فائل کے ساتھ [`hybrid.csv`](./example/hybrid.csv) فائل میں تلاش کرسکتے ہیں جس میں ریٹریول کے لئے استعمال ہونے والا ڈیٹا شامل ہے۔

**ایڈا:** ایک بار جب آپ اس کوڈ کو چلاتے ہیں تو ، آپ کو ریٹریور کے ذریعہ سی ایس وی فائل میں پائے جانے والے اعداد و شمار کو دیکھنا چاہئے ، جسے مارک ڈاؤن ٹیبل کے طور پر فارمیٹ کیا گیا ہے ، اس کے بعد سوال کا اے آئی سے تیار کردہ جواب۔ یہ دیکھنے کے لئے سوال کو تبدیل کرنے کی کوشش کریں کہ ریٹریوکردہ ڈیٹا اور ردعمل کیسے تبدیل ہوتا ہے۔ آپ غیر متعلقہ موضوعات کے بارے میں سوالات پوچھنے کی بھی کوشش کرسکتے ہیں یہ دیکھنے کے لئے کہ اے آئی ماڈل ان سے کیسے نمٹتا ہے۔

```متن
آؤٹ پٹ کی مثال:

پایا گیا 1 میچ:
| انسان | وقت کی مدت | تفصیل |
|---|---|---|
| لیونارڈو ڈا ونچی | 15 ویں صدی | اطالوی پولی میتھ اپنے فن اور ایجادات کے لئے جانا جاتا ہے۔ |
| آئزک نیوٹن | 17 ویں صدی | انگریزی ریاضی دان اور طبیعیات دان جنہوں نے حرکت اور عالمگیر کشش ثقل کے قوانین وضع کیے۔ |
```

**آپ:** یہ بہت اچھا ہے، میں دیکھ سکتا ہوں کہ آلہ استعمال کرتے وقت یہ کس طرح مفید ہوسکتا ہے، یا بلکہ یہ پہلے سے ہی کیا ہے یا ہوگا، وقت کا سفر الجھن ہے.

**ایڈا:** آپ بہت اچھا کر رہے ہیں. آئیے اگلے مرحلے کی طرف چلتے ہیں۔

## تفویض - ایڈا اور چارلس کی مدد کرنا

آر اے جی کے بارے میں جاننے کے بعد ، اب آپ ایڈا اور چارلس کو ان کے آلے کے ساتھ مدد کرنے کے لئے تیار ہیں۔ تاہم ، قریب سے معائنہ کرنے پر آلہ جانا پہچانا نظر آتا ہے۔

**آپ:** ٹائم بیٹل، کیا آپ جانتے ہیں کہ یہ کیا ہے؟

**ٹائم بیٹل:** یقینا، یہ میں ہوں، یا میں ہو جائوں گا. تاہم میں کچھ حصوں سے محروم ہوں. آئیے اس کے بارے میں سوچیں، میں بہت سے حصوں سے محروم ہوں، میرے پاس ابھی تک ایک شیل بھی نہیں ہے.

**ایڈا:** ٹائم بیٹل ایک ایسا آلہ ہے جو آپ کو وقت اور جگہ کے ذریعے سفر کرنے کی اجازت دیتا ہے ، یعنی ایک بار جب ہم اسے مناسب طریقے سے کام کرتے ہیں۔ جیسا کہ میں کہہ رہی تھی ، ہمیں اس میں ایک نئی خصوصیت شامل کرنے کی ضرورت ہے، ایک ریٹریول-اگمنٹڈ جنریشن (آر اے جی) ماڈیول. اس سے ہمیں سفر کے دوران مختلف اوقات سے معلومات اور ضروری سیاق و سباق کو ریٹریو کرنے میں مدد ملے گی۔ ہم اس بات کو یقینی بنانا چاہتے ہیں کہ ہم ہر طرح کے ذرائع کا حوالہ دیں، ویکیپیڈیا ایک اچھا آغاز ہے.

**آپ:** آپ کو میریکیا ضرورت ہے؟

**ایڈا:** یہاں مثالی کوڈ ہے جو ویکیپیڈیا سے ٹم برنرز لی کے بارے میں متنی معلومات حاصل کرتا ہے، ٹم ایک دن بہت اہم ہوگا.

```javascript
const response = await fetch('https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&redirects=true&explaintext&titles=Tim%20Berners-Lee');
const data = await response.json();
const text = Object.values(data.query.pages)[0]?.extract;
```

**آپ:** میں سمجھتا ہوں کہ میں اکیلا نہیں ہوں جو مستقبل میں گیا ہے؟

**ایڈا:**...

## حل

[حل](./solution/rag-www.js)

## علم کی جانچ پڑتال

**سوال**: آر اے جی سسٹم میں ریٹریور کا کردار کیا ہے؟

 -ریٹریور ان پٹ ڈیٹا کی بنیاد پر جوابات تیار کرتا ہے۔
 -ریٹریور ماڈل کے تربیتی اعداد و شمار کی بنیاد پر متعلقہ معلومات تیار کرتا ہے۔
 -ریٹریور بیرونی اعداد و شمار کے ذرائع سے متعلقہ معلومات تلاش کرتا ہے۔

[کوئز حل](./solution/solution-quiz.md)

## خود مطالعہ کے وسائل

- [ریٹریول-اگمنٹڈ جنریشن اینڈ انڈیکس](https://learn.microsoft.com/azure/ai-studio/concepts/retrieval-augmented-generation)
- **نمونہ ایپس**:
  * [آر اے جی کے ساتھ سرور لیس اے آئی چیٹ](https://github.com/Azure-Samples/serverless-chat-langchainjs/)
  * [یوٹیوب سے پوچھیں: آر اے جی پر مبنی یوٹیوب سوال و جواب اے پی آئی](https://github.com/Azure-Samples/langchainjs-quickstart-demo)
 - [مکمل ورکشاپ: آر اے جی کے ساتھ اپنا چیٹ جی پی ٹی بنائیں](https://moaw.dev/workshop/gh:azure-samples/azure-openai-rag-workshop/docs/workshop-qdrant.md)
